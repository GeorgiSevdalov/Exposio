<div class="dashboard-container">
  <div class="container">
    @if (currentUser$ | async; as user) {
    <div class="dashboard-content">
      <div class="dashboard-header">
        <h1>Welcome back, {{ user.email }}!</h1>
        <p>Manage your expositions and track your creative journey.</p>
      </div>

      @if (isLoading) {
      <div class="loading-section">
        <mat-spinner diameter="40"></mat-spinner>
        <p>Loading your data...</p>
      </div>
      } @else {
      <div class="dashboard-grid">
        <!-- Quick Actions -->
        <mat-card class="quick-actions-card">
          <mat-card-header>
            <mat-card-title>Quick Actions</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <div class="action-buttons">
              <button mat-raised-button color="primary" routerLink="/expositions/create">
                <mat-icon>add</mat-icon>
                Create Exposition
              </button>
              <button mat-stroked-button routerLink="/expositions">
                <mat-icon>collections</mat-icon>
                Browse Gallery
              </button>
              <button mat-stroked-button routerLink="/auth/profile">
                <mat-icon>person</mat-icon>
                View Profile
              </button>
            </div>
          </mat-card-content>
        </mat-card>

        <!-- Statistics -->
        <mat-card class="stats-card">
          <mat-card-header>
            <mat-card-title>Your Statistics</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <div class="stats-grid">
              <div class="stat-item">
                <mat-icon>collections</mat-icon>
                <div class="stat-content">
                  <span class="stat-number">{{ userExpositions.length }}</span>
                  <span class="stat-label">Expositions</span>
                </div>
              </div>
              <div class="stat-item">
                <mat-icon>image</mat-icon>
                <div class="stat-content">
                  <span class="stat-number">{{ totalImages }}</span>
                  <span class="stat-label">Total Images</span>
                </div>
              </div>
              <div class="stat-item">
                <mat-icon>favorite</mat-icon>
                <div class="stat-content">
                  <span class="stat-number">{{ totalLikes }}</span>
                  <span class="stat-label">Total Likes</span>
                </div>
              </div>
            </div>
          </mat-card-content>
        </mat-card>

        <!-- Recent Expositions -->
        <mat-card class="recent-expositions-card">
          <mat-card-header>
            <mat-card-title>Your Recent Expositions</mat-card-title>
            <div class="header-actions">
              @if (userExpositions.length > 3) {
              <button mat-button routerLink="/expositions">
                View All
              </button>
              }
            </div>
          </mat-card-header>
          <mat-card-content>
            @if (userExpositions.length > 0) {
            <div class="expositions-list">
              @for (exposition of recentExpositions; track exposition.id) {
              <div class="exposition-item" (click)="navigateToExposition(exposition.id)">
                <div class="exposition-image">
                  @if (exposition.images && exposition.images.length > 0) {
                  <img [src]="exposition.images[0]" [alt]="exposition.title">
                  } @else {
                  <div class="no-image">
                    <mat-icon>image</mat-icon>
                  </div>
                  }
                </div>
                <div class="exposition-info">
                  <h4>{{ exposition.title }}</h4>
                  <p>{{ exposition.created_at | date:'mediumDate' }}</p>
                  <div class="exposition-stats">
                    <span><mat-icon>favorite</mat-icon> {{ exposition.likes || 0 }}</span>
                    <span><mat-icon>image</mat-icon> {{ exposition.images?.length || 0 }}</span>
                  </div>
                </div>
                <div class="exposition-actions">
                  <button mat-icon-button (click)="editExposition($event, exposition.id)">
                    <mat-icon>edit</mat-icon>
                  </button>
                </div>
              </div>
              }
            </div>
            } @else {
            <div class="empty-state">
              <mat-icon>collections</mat-icon>
              <h4>No expositions yet</h4>
              <p>Create your first exposition to showcase your work!</p>
              <button mat-raised-button color="primary" routerLink="/expositions/create">
                <mat-icon>add</mat-icon>
                Create Your First Exposition
              </button>
            </div>
            }
          </mat-card-content>
        </mat-card>

        <!-- Account Summary -->
        <mat-card class="account-summary-card">
          <mat-card-header>
            <mat-card-title>Account Summary</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <div class="summary-info">
              <div class="summary-item">
                <span class="label">Member Since:</span>
                <span class="value">{{ user.created_at | date:'mediumDate' }}</span>
              </div>
              <div class="summary-item">
                <span class="label">Email:</span>
                <span class="value">{{ user.email }}</span>
              </div>
              @if (userExpositions.length > 0) {
              <div class="summary-item">
                <span class="label">Last Activity:</span>
                <span class="value">{{ lastActivity | date:'short' }}</span>
              </div>
              }
            </div>
          </mat-card-content>
          <mat-card-actions>
            <button mat-button routerLink="/auth/profile">
              <mat-icon>settings</mat-icon>
              Manage Account
            </button>
          </mat-card-actions>
        </mat-card>
      </div>
      }
    </div>
    } @else {
    <!-- Loading State -->
    <div class="loading-container">
      <mat-card>
        <mat-card-content>
          <p>Loading dashboard...</p>
        </mat-card-content>
      </mat-card>
    </div>
    }
  </div>
</div>