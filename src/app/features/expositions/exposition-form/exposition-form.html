<div class="form-container">
  <div class="container">
    @if (isLoading) {
      <div class="loading-state">
        <p>{{ isEditMode ? 'Loading exposition...' : 'Saving exposition...' }}</p>
      </div>
    } @else {
      <div class="form-content">
        <!-- Header -->
        <div class="form-header">
          <h1>{{ isEditMode ? 'Edit Exposition' : 'Create New Exposition' }}</h1>
          <p>{{ isEditMode ? 'Update your exposition details' : 'Share your creative work with the community' }}</p>
        </div>

        <!-- Form -->
        <mat-card class="form-card">
          <mat-card-content>
            <form [formGroup]="expositionForm" (ngSubmit)="onSubmit()" class="exposition-form">
              <!-- Title Field -->
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Title</mat-label>
                <input 
                  matInput 
                  formControlName="title"
                  placeholder="Enter exposition title"
                  maxlength="100">
                <mat-hint>Give your exposition a compelling title</mat-hint>
                @if (titleControl?.invalid && titleControl?.touched) {
                  <mat-error>{{ getTitleErrorMessage() }}</mat-error>
                }
              </mat-form-field>

              <!-- Description Field -->
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Description</mat-label>
                <textarea 
                  matInput 
                  formControlName="description"
                  placeholder="Describe your exposition..."
                  rows="4"
                  maxlength="1000">
                </textarea>
                <mat-hint>Optional: Tell viewers about your work ({{ descriptionControl?.value.length || 0 }}/1000)</mat-hint>
                @if (descriptionControl?.invalid && descriptionControl?.touched) {
                  <mat-error>{{ getDescriptionErrorMessage() }}</mat-error>
                }
              </mat-form-field>

              <!-- Images Section -->
              <div class="images-section">
                <h3>Images</h3>
                
                <!-- Add Image URL -->
                <div class="add-image-container">
                  <mat-form-field appearance="outline" class="image-url-field">
                    <mat-label>Image URL</mat-label>
                    <input 
                      matInput 
                      [formControl]="imageUrlControl"
                      placeholder="https://example.com/image.jpg"
                      (keydown.enter)="addImageUrl()">
                    <mat-hint>Add images from URLs (JPG, PNG, GIF, WebP)</mat-hint>
                  </mat-form-field>
                  <button 
                    mat-raised-button 
                    color="primary" 
                    type="button"
                    (click)="addImageUrl()"
                    [disabled]="!imageUrlControl.value?.trim()">
                    <mat-icon>add</mat-icon>
                    Add Image
                  </button>
                </div>

                <!-- Image List -->
                @if (imageUrls.length > 0) {
                  <div class="images-list">
                    @for (imageUrl of imageUrls; track $index) {
                      <div class="image-item">
                        <img [src]="imageUrl" [alt]="'Image ' + ($index + 1)" class="image-preview">
                        <div class="image-actions">
                          <span class="image-number">{{ $index + 1 }}</span>
                          <button 
                            mat-icon-button 
                            color="warn" 
                            type="button"
                            (click)="removeImage($index)"
                            [attr.aria-label]="'Remove image ' + ($index + 1)">
                            <mat-icon>delete</mat-icon>
                          </button>
                        </div>
                      </div>
                    }
                  </div>
                } @else {
                  <div class="no-images">
                    <mat-icon>image</mat-icon>
                    <p>No images added yet</p>
                    <p class="hint">Add at least one image to showcase your work</p>
                  </div>
                }
              </div>

              <!-- Form Actions -->
              <div class="form-actions">
                <button 
                  mat-stroked-button 
                  type="button" 
                  (click)="onCancel()">
                  Cancel
                </button>
                
                <button 
                  mat-raised-button 
                  color="primary" 
                  type="submit"
                  [disabled]="expositionForm.invalid || isLoading">
                  <mat-icon>{{ isEditMode ? 'save' : 'publish' }}</mat-icon>
                  {{ isEditMode ? 'Update Exposition' : 'Create Exposition' }}
                </button>
              </div>
            </form>
          </mat-card-content>
        </mat-card>
      </div>
    }
  </div>
</div>